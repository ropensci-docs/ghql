<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ghql">
<title>Introduction to ghql • ghql</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to ghql">
<meta property="og:description" content="ghql">
<meta property="og:image" content="https://docs.ropensci.org/ghql/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">ghql</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.1.099</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="active nav-item">
  <a class="nav-link" href="../articles/ghql.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/ghql/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to ghql</h1>
                        <h4 data-toc-skip class="author">Scott Chamberlain</h4>
            
            <h4 data-toc-skip class="date">2021-01-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/ghql/blob/HEAD/vignettes/ghql.Rmd" class="external-link"><code>vignettes/ghql.Rmd</code></a></small>
      <div class="d-none name"><code>ghql.Rmd</code></div>
    </div>

    
    
<p><code>ghql</code> - a GraphQL client for R</p>
<div class="section level2">
<h2 id="github-authentication">GitHub Authentication<a class="anchor" aria-label="anchor" href="#github-authentication"></a>
</h2>
<p>Note: To be clear, this R package isn’t just for the GitHub GraphQL API, but it is the most public GraphQL API we can think of, so is used in examples throughout here.</p>
<p>See <a href="https://docs.github.com/en/graphql/guides/forming-calls-with-graphql#authenticating-with-graphql" class="external-link uri">https://docs.github.com/en/graphql/guides/forming-calls-with-graphql#authenticating-with-graphql</a> for getting an OAuth token.</p>
<p>Store the token in a env var called <code>GITHUB_TOKEN</code></p>
</div>
<div class="section level2">
<h2 id="install">Install<a class="anchor" aria-label="anchor" href="#install"></a>
</h2>
<p>CRAN version</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ghql"</span><span class="op">)</span></span></code></pre></div>
<p>Development version</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"ropensci/ghql"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://docs.ropensci.org/ghql">"ghql"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://jeroen.r-universe.dev/jsonlite" class="external-link">"jsonlite"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org" class="external-link">"dplyr"</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="initialize-client">initialize client<a class="anchor" aria-label="anchor" href="#initialize-client"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">token</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"GITHUB_TOKEN"</span><span class="op">)</span></span>
<span><span class="va">con</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/GraphqlClient.html">GraphqlClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="st">"https://api.github.com/graphql"</span>,</span>
<span>  headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Authorization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Bearer "</span>, <span class="va">token</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-schema">load schema<a class="anchor" aria-label="anchor" href="#load-schema"></a>
</h2>
<p>Since not every GraphQL server has a schema at the base URL, have to manually load the schema in this case</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con</span><span class="op">$</span><span class="fu">load_schema</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="queries">Queries<a class="anchor" aria-label="anchor" href="#queries"></a>
</h2>
<p>Make a <code>Query</code> class object</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qry</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Query.html">Query</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>When you construct queries we check that they are properly formatted using the [graphql][] package that leverages the [libgraphqlparser][] C++ parser. If the query is malformed, we return a message as to why the query is malformed.</p>
<p>Get some stargazer counts</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qry</span><span class="op">$</span><span class="fu">query</span><span class="op">(</span><span class="st">'mydata'</span>, <span class="st">'{</span></span>
<span><span class="st">  repositoryOwner(login:"sckott") {</span></span>
<span><span class="st">    repositories(first: 5, orderBy: {field:PUSHED_AT,direction:DESC}, isFork:false) {</span></span>
<span><span class="st">      edges {</span></span>
<span><span class="st">        node {</span></span>
<span><span class="st">          name</span></span>
<span><span class="st">          stargazers {</span></span>
<span><span class="st">            totalCount</span></span>
<span><span class="st">          }</span></span>
<span><span class="st">        }</span></span>
<span><span class="st">      }</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}'</span><span class="op">)</span></span>
<span><span class="va">qry</span></span>
<span><span class="co">#&gt; &lt;ghql: query&gt;</span></span>
<span><span class="co">#&gt;   queries:</span></span>
<span><span class="co">#&gt;     mydata</span></span>
<span><span class="va">qry</span><span class="op">$</span><span class="va">queries</span><span class="op">$</span><span class="va">mydata</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  {</span></span>
<span><span class="co">#&gt;   repositoryOwner(login:"sckott") {</span></span>
<span><span class="co">#&gt;     repositories(first: 5, orderBy: {field:PUSHED_AT,direction:DESC}, isFork:false) {</span></span>
<span><span class="co">#&gt;       edges {</span></span>
<span><span class="co">#&gt;         node {</span></span>
<span><span class="co">#&gt;           name</span></span>
<span><span class="co">#&gt;           stargazers {</span></span>
<span><span class="co">#&gt;             totalCount</span></span>
<span><span class="co">#&gt;           }</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># returns json</span></span>
<span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">con</span><span class="op">$</span><span class="fu">exec</span><span class="op">(</span><span class="va">qry</span><span class="op">$</span><span class="va">queries</span><span class="op">$</span><span class="va">mydata</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "{\"data\":{\"repositoryOwner\":{\"repositories\":{\"edges\":[{\"node\":{\"name\":\"cranchecksdocs\",\"stargazers\":{\"totalCount\":6}}},{\"node\":{\"name\":\"badges\",\"stargazers\":{\"totalCount\":0}}},{\"node\":{\"name\":\"mutant-proposal\",\"stargazers\":{\"totalCount\":0}}},{\"node\":{\"name\":\"extcite\",\"stargazers\":{\"totalCount\":6}}},{\"node\":{\"name\":\"Headstart\",\"stargazers\":{\"totalCount\":140}}}]}}}}\n"</span></span>
<span><span class="co"># parse to an R list</span></span>
<span><span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">fromJSON</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; $data$repositoryOwner</span></span>
<span><span class="co">#&gt; $data$repositoryOwner$repositories</span></span>
<span><span class="co">#&gt; $data$repositoryOwner$repositories$edges</span></span>
<span><span class="co">#&gt;         node.name node.totalCount</span></span>
<span><span class="co">#&gt; 1  cranchecksdocs               6</span></span>
<span><span class="co">#&gt; 2          badges               0</span></span>
<span><span class="co">#&gt; 3 mutant-proposal               0</span></span>
<span><span class="co">#&gt; 4         extcite               6</span></span>
<span><span class="co">#&gt; 5       Headstart             140</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="parameterize-a-query-by-a-variable">Parameterize a query by a variable<a class="anchor" aria-label="anchor" href="#parameterize-a-query-by-a-variable"></a>
</h2>
<p>Define a query</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qry</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Query.html">Query</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">qry</span><span class="op">$</span><span class="fu">query</span><span class="op">(</span><span class="st">'getgeninfo'</span>, <span class="st">'query getGeneInfo($genId: String!){</span></span>
<span><span class="st">  geneInfo(geneId: $genId) {</span></span>
<span><span class="st">    id</span></span>
<span><span class="st">    symbol</span></span>
<span><span class="st">    chromosome</span></span>
<span><span class="st">    start</span></span>
<span><span class="st">    end</span></span>
<span><span class="st">    bioType</span></span>
<span><span class="st">    __typename</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}'</span><span class="op">)</span></span></code></pre></div>
<p>Define a variable as a named list</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>genId <span class="op">=</span> <span class="st">'ENSG00000137033'</span><span class="op">)</span></span></code></pre></div>
<p>Creat a clint and make a request, passing in the query and then the variables</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/GraphqlClient.html">GraphqlClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">'https://genetics-api.opentargets.io/graphql'</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">con</span><span class="op">$</span><span class="fu">exec</span><span class="op">(</span><span class="va">qry</span><span class="op">$</span><span class="va">queries</span><span class="op">$</span><span class="va">getgeninfo</span>, <span class="va">variables</span><span class="op">)</span></span>
<span><span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">fromJSON</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; $data$geneInfo</span></span>
<span><span class="co">#&gt; $data$geneInfo$id</span></span>
<span><span class="co">#&gt; [1] "ENSG00000137033"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data$geneInfo$symbol</span></span>
<span><span class="co">#&gt; [1] "IL33"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data$geneInfo$chromosome</span></span>
<span><span class="co">#&gt; [1] "9"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data$geneInfo$start</span></span>
<span><span class="co">#&gt; [1] 6215786</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data$geneInfo$end</span></span>
<span><span class="co">#&gt; [1] 6257983</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data$geneInfo$bioType</span></span>
<span><span class="co">#&gt; [1] "protein_coding"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data$geneInfo$`__typename`</span></span>
<span><span class="co">#&gt; [1] "Gene"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-datacite">Example: Datacite<a class="anchor" aria-label="anchor" href="#example-datacite"></a>
</h2>
<p><a href="https://datacite.org/" class="external-link">Datacite</a> provides DOIs for research data. Check out the <a href="https://support.datacite.org/docs/datacite-graphql-api-guide" class="external-link">Datacite GraphQL docs</a> to get started. A minimal example:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/GraphqlClient.html">GraphqlClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"https://api.datacite.org/graphql"</span><span class="op">)</span></span>
<span><span class="va">qry</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Query.html">Query</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">qry</span><span class="op">$</span><span class="fu">query</span><span class="op">(</span><span class="st">'dc'</span>, <span class="st">'{</span></span>
<span><span class="st">  publications(query: "climate") {</span></span>
<span><span class="st">    totalCount</span></span>
<span><span class="st"></span></span>
<span><span class="st">    nodes {</span></span>
<span><span class="st">      id</span></span>
<span><span class="st">      titles {</span></span>
<span><span class="st">        title</span></span>
<span><span class="st">      }</span></span>
<span><span class="st">      descriptions {</span></span>
<span><span class="st">        description</span></span>
<span><span class="st">      }</span></span>
<span><span class="st">      creators {</span></span>
<span><span class="st">        name</span></span>
<span><span class="st">        familyName</span></span>
<span><span class="st">      }</span></span>
<span><span class="st">      fundingReferences {</span></span>
<span><span class="st">        funderIdentifier</span></span>
<span><span class="st">        funderName</span></span>
<span><span class="st">        awardTitle</span></span>
<span><span class="st">        awardNumber</span></span>
<span><span class="st">      }</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}'</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">con</span><span class="op">$</span><span class="fu">exec</span><span class="op">(</span><span class="va">qry</span><span class="op">$</span><span class="va">queries</span><span class="op">$</span><span class="va">dc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">fromJSON</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">publications</span><span class="op">$</span><span class="va">nodes</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                     id                                titles</span></span>
<span><span class="co">#&gt; 1 https://doi.org/10.4122/1.1000000046 Single Cell Protein from Landfill Gas</span></span>
<span><span class="co">#&gt; 2 https://doi.org/10.4122/1.1000000046 Single Cell Protein from Landfill Gas</span></span>
<span><span class="co">#&gt; 3 https://doi.org/10.4122/1.1000000047 Single Cell Protein from Landfill Gas</span></span>
<span><span class="co">#&gt; 4 https://doi.org/10.4122/1.1000000047 Single Cell Protein from Landfill Gas</span></span>
<span><span class="co">#&gt; 5 https://doi.org/10.4122/1.1000000048 Single Cell Protein from Landfill Gas</span></span>
<span><span class="co">#&gt; 6 https://doi.org/10.4122/1.1000000048 Single Cell Protein from Landfill Gas</span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       descriptions</span></span>
<span><span class="co">#&gt; 1 Municipal solid waste (MSW) landfills are one of the largest human-generated sources of methane emissions in the United States and other countries globally. Methane is believed to be a very potent greenhouse gas that is a key contributor to global climate change, over 21 times stronger than CO2. Methane also has a short (10-year) atmospheric life. Because methane is both potent and short-lived, reducing methane emissions from MSW landfills is one of the best ways to achieve a near-term beneficial impact in mitigating global climate change. The United States Environmental Protection Agency estimates that a landfill gas (LFG) project will capture roughly 60-90% of the methane emitted from the landfill, depending on system design and effectiveness. The captured methane can be then purified and used for industrial applications, as in this case the production of SCP. Utilizing methane in this way decreases its demand from fossil fuels which is its traditional source.</span></span>
<span><span class="co">#&gt; 2 Municipal solid waste (MSW) landfills are one of the largest human-generated sources of methane emissions in the United States and other countries globally. Methane is believed to be a very potent greenhouse gas that is a key contributor to global climate change, over 21 times stronger than CO2. Methane also has a short (10-year) atmospheric life. Because methane is both potent and short-lived, reducing methane emissions from MSW landfills is one of the best ways to achieve a near-term beneficial impact in mitigating global climate change. The United States Environmental Protection Agency estimates that a landfill gas (LFG) project will capture roughly 60-90% of the methane emitted from the landfill, depending on system design and effectiveness. The captured methane can be then purified and used for industrial applications, as in this case the production of SCP. Utilizing methane in this way decreases its demand from fossil fuels which is its traditional source.</span></span>
<span><span class="co">#&gt; 3 Municipal solid waste (MSW) landfills are one of the largest human-generated sources of methane emissions in the United States and other countries globally. Methane is believed to be a very potent greenhouse gas that is a key contributor to global climate change, over 21 times stronger than CO2. Methane also has a short (10-year) atmospheric life. Because methane is both potent and short-lived, reducing methane emissions from MSW landfills is one of the best ways to achieve a near-term beneficial impact in mitigating global climate change. The United States Environmental Protection Agency estimates that a landfill gas (LFG) project will capture roughly 60-90% of the methane emitted from the landfill, depending on system design and effectiveness. The captured methane can be then purified and used for industrial applications, as in this case the production of SCP. Utilizing methane in this way decreases its demand from fossil fuels which is its traditional source.</span></span>
<span><span class="co">#&gt; 4 Municipal solid waste (MSW) landfills are one of the largest human-generated sources of methane emissions in the United States and other countries globally. Methane is believed to be a very potent greenhouse gas that is a key contributor to global climate change, over 21 times stronger than CO2. Methane also has a short (10-year) atmospheric life. Because methane is both potent and short-lived, reducing methane emissions from MSW landfills is one of the best ways to achieve a near-term beneficial impact in mitigating global climate change. The United States Environmental Protection Agency estimates that a landfill gas (LFG) project will capture roughly 60-90% of the methane emitted from the landfill, depending on system design and effectiveness. The captured methane can be then purified and used for industrial applications, as in this case the production of SCP. Utilizing methane in this way decreases its demand from fossil fuels which is its traditional source.</span></span>
<span><span class="co">#&gt; 5 Municipal solid waste (MSW) landfills are one of the largest human-generated sources of methane emissions in the United States and other countries globally. Methane is believed to be a very potent greenhouse gas that is a key contributor to global climate change, over 21 times stronger than CO2. Methane also has a short (10-year) atmospheric life. Because methane is both potent and short-lived, reducing methane emissions from MSW landfills is one of the best ways to achieve a near-term beneficial impact in mitigating global climate change. The United States Environmental Protection Agency estimates that a landfill gas (LFG) project will capture roughly 60-90% of the methane emitted from the landfill, depending on system design and effectiveness. The captured methane can be then purified and used for industrial applications, as in this case the production of SCP. Utilizing methane in this way decreases its demand from fossil fuels which is its traditional source.</span></span>
<span><span class="co">#&gt; 6 Municipal solid waste (MSW) landfills are one of the largest human-generated sources of methane emissions in the United States and other countries globally. Methane is believed to be a very potent greenhouse gas that is a key contributor to global climate change, over 21 times stronger than CO2. Methane also has a short (10-year) atmospheric life. Because methane is both potent and short-lived, reducing methane emissions from MSW landfills is one of the best ways to achieve a near-term beneficial impact in mitigating global climate change. The United States Environmental Protection Agency estimates that a landfill gas (LFG) project will capture roughly 60-90% of the methane emitted from the landfill, depending on system design and effectiveness. The captured methane can be then purified and used for industrial applications, as in this case the production of SCP. Utilizing methane in this way decreases its demand from fossil fuels which is its traditional source.</span></span>
<span><span class="co">#&gt;                                                            creators</span></span>
<span><span class="co">#&gt; 1 Babi, Deenesh, Price, Jason, Woodley, Prof. John, Babi, Price, NA</span></span>
<span><span class="co">#&gt; 2 Babi, Deenesh, Price, Jason, Woodley, Prof. John, Babi, Price, NA</span></span>
<span><span class="co">#&gt; 3 Babi, Deenesh, Price, Jason, Woodley, Prof. John, Babi, Price, NA</span></span>
<span><span class="co">#&gt; 4 Babi, Deenesh, Price, Jason, Woodley, Prof. John, Babi, Price, NA</span></span>
<span><span class="co">#&gt; 5 Babi, Deenesh, Price, Jason, Woodley, Prof. John, Babi, Price, NA</span></span>
<span><span class="co">#&gt; 6 Babi, Deenesh, Price, Jason, Woodley, Prof. John, Babi, Price, NA</span></span>
<span><span class="co">#&gt;   fundingReferences</span></span>
<span><span class="co">#&gt; 1              NULL</span></span>
<span><span class="co">#&gt; 2              NULL</span></span>
<span><span class="co">#&gt; 3              NULL</span></span>
<span><span class="co">#&gt; 4              NULL</span></span>
<span><span class="co">#&gt; 5              NULL</span></span>
<span><span class="co">#&gt; 6              NULL</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-countries-data">Example: Countries Data<a class="anchor" aria-label="anchor" href="#example-countries-data"></a>
</h2>
<p>A public GraphQL API for information about countries, continents, and languages. This project uses Countries List and provinces as data sources, so the schema follows the shape of that data, with a few exceptions:</p>
<p>Link to the GraphQL schema api</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">link</span> <span class="op">&lt;-</span> <span class="st">'https://countries.trevorblades.com/'</span></span></code></pre></div>
<p>Create a new graphqlClient object</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/GraphqlClient.html">GraphqlClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>url <span class="op">=</span> <span class="va">link</span><span class="op">)</span></span></code></pre></div>
<p>Define a Graphql Query</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">query</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">query($code: ID!){</span></span>
<span><span class="st">  country(code: $code){</span></span>
<span><span class="st">    name</span></span>
<span><span class="st">    native</span></span>
<span><span class="st">    capital</span></span>
<span><span class="st">    currency</span></span>
<span><span class="st">    phone</span></span>
<span><span class="st">    languages{</span></span>
<span><span class="st">      code</span></span>
<span><span class="st">      name</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}'</span></span></code></pre></div>
<p>The <code>ghql</code> query class and define query in a character string</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Query.html">Query</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">query</span><span class="op">(</span><span class="st">'link'</span>, <span class="va">query</span><span class="op">)</span></span></code></pre></div>
<p>Inspecting the schema</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new</span><span class="op">$</span><span class="va">link</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; query($code: ID!){</span></span>
<span><span class="co">#&gt;   country(code: $code){</span></span>
<span><span class="co">#&gt;     name</span></span>
<span><span class="co">#&gt;     native</span></span>
<span><span class="co">#&gt;     capital</span></span>
<span><span class="co">#&gt;     currency</span></span>
<span><span class="co">#&gt;     phone</span></span>
<span><span class="co">#&gt;     languages{</span></span>
<span><span class="co">#&gt;       code</span></span>
<span><span class="co">#&gt;       name</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span></code></pre></div>
<p>define a variable as a named list</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  code <span class="op">=</span> <span class="st">"DE"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Making a request, passing in the query and then the variables. Then you convert the raw object to a structured json object</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="va">con</span><span class="op">$</span><span class="fu">exec</span><span class="op">(</span><span class="va">new</span><span class="op">$</span><span class="va">link</span>, variables <span class="op">=</span> <span class="va">variable</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">fromJSON</a></span><span class="op">(</span>flatten <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; $data$country</span></span>
<span><span class="co">#&gt; $data$country$name</span></span>
<span><span class="co">#&gt; [1] "Germany"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data$country$native</span></span>
<span><span class="co">#&gt; [1] "Deutschland"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data$country$capital</span></span>
<span><span class="co">#&gt; [1] "Berlin"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data$country$currency</span></span>
<span><span class="co">#&gt; [1] "EUR"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data$country$phone</span></span>
<span><span class="co">#&gt; [1] "49"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data$country$languages</span></span>
<span><span class="co">#&gt;   code   name</span></span>
<span><span class="co">#&gt; 1   de German</span></span></code></pre></div>
<p>Convert the json data into a tibble object</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">country_data</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">country</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">country_data</span></span>
<span><span class="co">#&gt; # A tibble: 1 x 6</span></span>
<span><span class="co">#&gt;   name    native      capital currency phone languages$code $name </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;          &lt;chr&gt; </span></span>
<span><span class="co">#&gt; 1 Germany Deutschland Berlin  EUR      49    de             German</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-a-local-graphql-server">run a local GraphQL server<a class="anchor" aria-label="anchor" href="#run-a-local-graphql-server"></a>
</h2>
<ul>
<li>Copy the <code>server.js</code> file from this package located at <code>inst/server.js</code> somewhere on your machine. Can locate it on your machine like <code>system.file("js/server.js", package = "ghql")</code>. Or you can run the file from where it’s at, up to you.</li>
<li>Make sure node is installed. If not, see <a href="https://nodejs.org" class="external-link uri">https://nodejs.org</a>
</li>
<li>Run <code>node server.js</code>
</li>
<li>Navigate to your browser - go to <a href="http://localhost:4000/graphql" class="external-link uri">http://localhost:4000/graphql</a>
</li>
<li>Back in R, user that URL to connect</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">con</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/GraphqlClient.html">GraphqlClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"http://localhost:4000/graphql"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;ghql client&gt;</span></span>
<span><span class="co">#&gt;   url: http://localhost:4000/graphql</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xxx</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Query.html">Query</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">xxx</span><span class="op">$</span><span class="fu">query</span><span class="op">(</span><span class="st">'query'</span>, <span class="st">'{</span></span>
<span><span class="st">  __schema {</span></span>
<span><span class="st">    queryType {</span></span>
<span><span class="st">      name, </span></span>
<span><span class="st">      fields {</span></span>
<span><span class="st">        name,</span></span>
<span><span class="st">        description</span></span>
<span><span class="st">      }</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con</span><span class="op">$</span><span class="fu">exec</span><span class="op">(</span><span class="va">xxx</span><span class="op">$</span><span class="va">queries</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; $data$`__schema`</span></span>
<span><span class="co">#&gt; $data$`__schema`$queryType</span></span>
<span><span class="co">#&gt; $data$`__schema`$queryType$name</span></span>
<span><span class="co">#&gt; [1] "Query"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $data$`__schema`$queryType$fields</span></span>
<span><span class="co">#&gt;    name description</span></span>
<span><span class="co">#&gt; 1 hello            </span></span>
<span><span class="co">#&gt; 2  name </span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
